- position = 0
- Broadcast.current.published.order(Arel.sql("RANDOM()")).where.not(category: Admin::Category.find_by(slug: "faqs")).limit(1).each do |broadcast|
  - if first_image_url(broadcast).present?
    - background = "myapnea-black-bg"
  - else
    - background = "myapnea-dark-blue-bg"

  .anchor-menu{ id: "blog-#{position}"}
  .page-box.d-flex.flex-column.justify-content-around.overflow-hidden{ class: background, style: "position: relative;" }
    .background-blog-image.background-blur{ style: "background-image: url(#{first_image_url(broadcast)});" }
    .container
      .landing-blog-title{ style: "border: 0;" }
        .small{ style: "font-variant: small-caps;" } Featured Article
      .landing-blog-info
        .landing-blog-title= broadcast.title
        .landing-blog-content{ style: "position: relative;" }
          = strip_tags(simple_markdown(broadcast.description, target_blank: false)).gsub(/\r/, " ").gsub(/\n/, " ").truncate(500, separator: ".", omission: ".").html_safe

          .d-none.d-sm-block{ style: "position: absolute;right: -1rem; bottom: -1rem;" }
            = link_to blog_post_path(broadcast.url_hash), class: "btn btn-accent btn-lg" do
              Read more
              %i.fa.fa-caret-right

          .d-block.d-sm-none{ style: "position: absolute;right: -.25rem; bottom: -.25rem;" }
            = link_to blog_post_path(broadcast.url_hash), class: "btn btn-sm btn-accent" do
              Read more
              %i.fa.fa-caret-right
      - position += 1
      - if true
        = link_to "#research", data: { object: "scroll-anchor" }, class: "scroll-down-arrow-visible link-unstyled" do
          %i.fa.fa-chevron-down.text-white
      - else
        = link_to "#blog-#{position}", data: { object: "scroll-anchor" }, class: "scroll-down-arrow-visible link-unstyled" do
          %i.fa.fa-chevron-down.text-white

- if false
  .card-deck.flex-column.flex-md-row
    - Broadcast.current.published.order(publish_date: :desc, id: :desc).limit(3).each do |broadcast|
      .card.background-image-container.mb-3.mb-md-0{ data: { object: "show-fullscreen-blog", broadcast_id: broadcast.id }, style: "cursor: pointer;" }
        .background-image{ style: "background-image: url(#{first_image_url(broadcast)});" }
        .card-body.myapnea-blue-transparent-bg.myapnea-border-accent.d-flex.align-items-center{ style: "position: relative;" }
          %h4= broadcast.title
      .blog-fullscreen-backdrop{ data: { broadcast_id: broadcast.id } }
        .blog-fullscreen-content.d-flex.flex-column.justify-content-around
          .background-blog-image.background-blur{ style: "background-image: url(#{first_image_url(broadcast)});", data: { object: "close-fullscreen-blog", broadcast_id: broadcast.id } }
          %div{ style: "position: absolute; top: 0; right: 1rem;font-size: 2rem;cursor: pointer;" }
            = link_to "#", class: "link-white no-underline", data: { object: "close-fullscreen-blog", broadcast_id: broadcast.id } do
              &times;
          .container
            .landing-blog-info
              .landing-blog-title= broadcast.title
              .landing-blog-content{ style: "position: relative;" }
                = strip_tags(simple_markdown(broadcast.description, target_blank: false)).gsub(/\r/, " ").gsub(/\n/, " ").truncate(500, separator: ".", omission: ".").html_safe

                .d-none.d-sm-block{ style: "position: absolute;right: -1rem; bottom: -1rem;" }
                  = link_to blog_post_path(broadcast.url_hash), class: "btn btn-accent btn-lg" do
                    Read more
                    %i.fa.fa-caret-right

                .d-block.d-sm-none{ style: "position: absolute;right: -.25rem; bottom: -.25rem;" }
                  = link_to blog_post_path(broadcast.url_hash), class: "btn btn-sm btn-accent" do
                    Read more
                    %i.fa.fa-caret-right
