%button.btn.btn-default{data: { object: 'show-todays-users' } }
  New users today:
  %span.f500= @all_users.where("created_at > ?", Time.zone.now.beginning_of_day).count
%button.btn.btn-default{data: { object: 'show-this-weeks-users' } }
  New users this week:
  %span.f500= @all_users.where("created_at > ?", Time.zone.now.beginning_of_week(start_day = :sunday)).count
= render partial: 'layouts/partials/per_page', locals: { per_page: 40, object_count: @users.total_count }

%table.table.table-striped
  %thead
    %tr
      %th Name
      %th Email
      %th{ style: "white-space:nowrap" } Recent Activity
      %th Owner
      %th Moderator
      %th Excluded from Exports
      %th{ style: "white-space:nowrap" } Surveys Completed
      %th
  - @users.each do |user|
    %tr{ class: "#{'todays-users' if user.created_at.today?} #{'this-weeks-users' if user.created_at > Time.zone.now.beginning_of_week(start_day = :sunday)}"}
      %td{ style: 'white-space:nowrap' }
        = render 'forums/user_image_no_border', user: user, size: 18
        = link_to user.name, user_path(user)
      %td= user.email
      %td
        - if user.current_sign_in_at
          = time_ago_in_words(user.current_sign_in_at)
          ago
      %td{ style: "text-align:center" }
        = simple_check user.owner?
      %td{ style: "text-align:center" }
        = simple_check user.moderator?
      %td{ style: "text-align:center" }
        = simple_check !user.include_in_exports?
      %td
        = user.completed_answer_sessions.count
      %td{ style: 'white-space:nowrap' }
        = link_to 'Edit', edit_user_path(user), class: 'btn btn-default btn-xs'
        - unless current_user == user
          = link_to 'Delete', user_path(user), method: :delete, class: 'btn btn-xs btn-danger', data: { confirm: "Are you sure you want to delete User #{user.name}?" }

%div{ style: "text-align:center" }= paginate @users, theme: 'bootstrap'
