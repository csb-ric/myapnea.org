%nav.navbar.navbar-default.navbar-fixed-top{ role: 'navigation' }
  .container
    .navbar-header
      %button.navbar-toggle{ type: 'button', data: { toggle: 'collapse', target: '.navbar-full-menu' } }
        %span.sr-only Toggle navigation
        %span.icon-bar
        %span.icon-bar
        %span.icon-bar
      = link_to 'MyApnea', root_path, class: 'navbar-brand navbar-hide-scrolled'
      - if @menu_title || @title
        = link_to '#top', data: { object: 'remove-collapse-in scroll-anchor', target: '.navbar-full-menu' }, class: 'navbar-brand navbar-show-scrolled' do
          %i.fa.fa-level-up.fa-flip-horizontal{ aria: { hidden: 'true' } }
          = (@menu_title || @title).truncate(50).html_safe
    .collapse.navbar-collapse.navbar-full-menu
      %ul.nav.navbar-nav.navbar-hide-scrolled.hidden-xs
        %li{ class: "#{'active' if current_page?(root_url) || current_page?(dashboard_path)}" }
          = link_to dashboard_path do
            Dashboard
        %li{ class: "#{'active' if %w(topics).include?(params[:controller])}" }
          = link_to topics_path do
            Forum
        - if false
          %li{ class: "#{'active' if current_page?(surveys_path)}" }
            = link_to surveys_path do
              Surveys
        %li{ class: "#{'active' if %w(blog).include?(params[:controller])}" }
          = link_to blog_path do
            Blog

      .hidden-sm.hidden-md.hidden-lg
        = form_tag search_path, method: :get, id: 'navigation-search-form-mobile', class: 'navbar-form' do
          .form-group2
            .input-group
              = text_field_tag :search, params[:search], class: 'form-control', placeholder: 'Search MyApnea', autocomplete: 'off', id: 'navigation-search-mobile'
              %span.input-group-btn
                = link_to '#', data: { object: 'suppress-click' }, class: 'btn btn-primary-dark', name: nil, id: 'navigation-form-search-btn-mobile' do
                  %span.glyphicon.glyphicon-search

      %ul.nav.navbar-nav.hidden-sm.hidden-md.hidden-lg
        %li{ class: "#{'active' if current_page?(root_url) || current_page?(landing_path)}" }
          = link_to landing_path do
            Dashboard
        %li{ class: "#{'active' if %w(topics).include?(params[:controller])}" }
          = link_to topics_path do
            Forum
        - if false
          %li{ class: "#{'active' if current_page?(surveys_path)}" }
            = link_to surveys_path do
              Surveys
        %li{ class: "#{'active' if %w(blog).include?(params[:controller])}" }
          = link_to blog_path do
            Blog
        - if current_user
          %li{ class: "#{'active' if current_page?(settings_path)}" }
            = link_to settings_path do
              Settings

      - if current_user
        %form.navbar-form.navbar-right
          = link_to 'Logout', destroy_user_session_path, class: 'btn btn-primary-dark'
      - else
        %form.navbar-form.navbar-right
          = link_to 'Sign in', new_user_session_path, class: 'btn btn-primary-dark'

      .search-bar-container
        .full-search-bar
          = form_tag search_path, method: :get, id: 'navigation-search-form', class: 'navbar-form navbar-right hidden-xs hidden-sm', style: 'margin-right: -25px' do
            .form-group
              .input-group
                = text_field_tag :search, params[:search], class: 'form-control', placeholder: 'Search MyApnea', autocomplete: 'off', id: 'navigation-search'
                %span.input-group-btn
                  = link_to '#', data: { object: 'suppress-click' }, class: 'btn btn-primary-dark', name: nil, id: 'navigation-form-search-btn' do
                    %span.glyphicon.glyphicon-search

      .tiny-search-icon
        %form.navbar-form.navbar-right.hidden-xs.hidden-sm{ style: 'margin-right: -25px' }
          = link_to '#', data: { object: 'show-search-bar' }, class: 'btn btn-primary-dark', name: nil do
            %span.glyphicon.glyphicon-search

        %ul.nav.navbar-nav.navbar-right
          - if current_user
            %li.hidden-xs{ class: current_page?(notifications_path) ? 'active' : nil }
              = link_to notifications_path, class: "notifications-link #{'notifications-link-active' if current_user.unread_notifications?}" do
                %span.glyphicon.glyphicon-bell
            %li.dropdown.hidden-xs
              = link_to '#', class: 'dropdown-toggle', data: { object: 'dropdown', toggle: 'dropdown' } do
                = current_user.first_name
                %span.caret
              %ul.dropdown-menu{ role: 'menu' }
                %li
                  = link_to settings_path do
                    %i.fa.fa-cogs
                    Settings
                %li.divider
                %li
                  = link_to about_path do
                    = image_tag 'myapnea/icons/myapnea-logo-transparent.png', size: '16x16', style: 'margin-top: -4px;'
                    About MyApnea
                %li.divider.visible-sm
                %li.visible-sm
                  = link_to destroy_user_session_path do
                    %span.glyphicon.glyphicon-log-out
                    Logout
