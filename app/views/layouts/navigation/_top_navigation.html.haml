/ Fixed navbar
%nav.navbar.navbar-fixed-top
  .container
    .navbar-header
      %button.pull-right.navbar-toggle.collapsed{ type: 'button', data: { toggle: 'collapse', target: '#navbar-myapnea' }, aria: { expanded: 'false' } }
        %span.sr-only Toggle navigation
        %span.icon-bar
        %span.icon-bar
        %span.icon-bar
      = link_to root_path, class: 'navbar-brand' do
        = image_tag 'myapnea/logos/MyApneaLogo_border_notext_173x46.png'
    #navbar-myapnea.collapse.navbar-collapse
      - if current_user
        %form.navbar-form.navbar-right.hidden-xs.hidden-sm
          = link_to 'Logout', destroy_user_session_path, method: :delete, class: 'btn btn-primary'
      - else
        %form.navbar-form.navbar-right.hidden-xs.hidden-sm
          = link_to 'Sign up', new_user_registration_path, class: 'btn btn-primary' unless current_page?(new_user_registration_path)
          = link_to 'Sign in', new_user_session_path, class: 'btn btn-primary'


      %div{ style: 'position: relative' }
        .full-search-bar
          = form_tag search_path, method: :get, id: 'navigation-search-form', class: 'navbar-form navbar-right hidden-xs hidden-sm', style: 'margin-right: -25px' do
            .form-group
              .input-group
                = text_field_tag :search, params[:search], class: 'form-control', placeholder: 'Search MyApnea', autocomplete: 'off', id: 'navigation-search'
                %span.input-group-btn
                  = link_to '#', data: { object: 'suppress-click' }, class: 'btn btn-primary', name: nil, id: 'navigation-form-search-btn' do
                    %span.glyphicon.glyphicon-search

      .tiny-search-icon
        %form.navbar-form.navbar-right.hidden-xs.hidden-sm{ style: 'margin-right: -25px' }
          = link_to '#', data: { object: 'show-search-bar' }, class: 'btn btn-primary', name: nil do
            %span.glyphicon.glyphicon-search

        %ul.nav.navbar-nav.navbar-right
          - if current_user
            %li.hidden-sm.hidden-xs
              = link_to notifications_path, class: "#{'notifications-link' if current_user.unread_notifications?}" do
                %span.glyphicon.glyphicon-bell
          %li{ class: "#{'active' if @active_top_nav_link == :home}" }
            = link_to "#{current_user ? 'Dashboard' : 'Home'}", root_path
          %li{ class: params[:controller] == 'blog' ? 'active' : nil }
            = link_to 'Blog', blog_path
          %li{ class: params[:controller].in?(%w(chapters topics posts)) ? 'active' : nil }
            = link_to 'Forum', chapters_path
          %li{ class: "#{'active' if @active_top_nav_link == :surveys }" }
            = link_to 'Surveys', surveys_path

          - if current_user
            %li.dropdown.hidden-xs.hidden-sm
              = link_to '#', class: 'dropdown-toggle', data: { object: 'dropdown', toggle: 'dropdown' } do
                = image_tag user_photo_url(current_user), size: '26', alt: '', class: 'img-rounded', style: 'float:left;margin-right:5px;margin-top:-2px'
                %span.caret
              %ul.dropdown-menu{ role: "menu" }
                %li= link_to 'Invite others', members_invites_path
                %li= link_to 'Settings', account_path
                %li= link_to 'Help', faqs_path
                - if current_user.owner? || current_user.moderator?
                  %li.divider
                  %li= link_to 'Admin Dashboard', admin_path
                - if current_user.can_build_surveys?
                  %li.divider
                  %li= link_to 'Build a Survey', builder_path
            %li.visible-xs
              = link_to 'Settings', account_path

      - if current_user
        %form.navbar-form.navbar-right.visible-xs.visible-sm
          = link_to 'Logout', destroy_user_session_path, method: :delete, class: 'btn btn-primary'
      - else
        %form.navbar-form.navbar-right.visible-xs.visible-sm
          = link_to 'Sign up', new_user_registration_path, class: 'btn btn-primary' unless current_page?(new_user_registration_path)
          = link_to 'Sign in', new_user_session_path, class: 'btn btn-primary'
